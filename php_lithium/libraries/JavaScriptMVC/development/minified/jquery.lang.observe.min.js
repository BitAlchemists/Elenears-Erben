(function(){var k=$.isArray,g=function(a){return typeof a==="object"&&a!==null&&a},j=$.makeArray,o=$.each,l=function(a,c,b){a=k(a)?new $.Observe.List(a):new $.Observe(a);a.bind("change"+b._namespace,function(d){var e=$.makeArray(arguments);d=e.shift();e[0]=c+(e[0]!="*"?"."+e[0]:"");$([b]).trigger(d,e)});return a},p=0,h=null,q=function(){if(!h){h=[];return true}},i=function(a,c,b){a=$([a]);if(h)h.push({t:a,ev:c,args:b});else return a.trigger(c,b)},r=function(){var a=h.length,c=h.slice(0),b;h=null;
for(var d=0;d<a;d++){b=c[d];$(b.t).trigger(b.ev,b.args)}},m=function(a,c,b){a.each(function(d,e){b[d]=g(e)&&typeof e[c]=="function"?e[c]():e});return b};$.Class("jQuery.Observe",{init:function(a){this._namespace=".observe"+ ++p;for(var c in a)if(a.hasOwnProperty(c)){var b=a[c];if(g(b))a[c]=l(b,c,this)}this._data=a||{}},attr:function(a,c){if(c===undefined)return this._get(a);else{this._set(a,c);return this}},each:function(){return o.apply(null,[this._data].concat(j(arguments)))},removeAttr:function(a){a=
k(a)?a:a.split(".");var c=a.shift();current=this._data[c];if(a.length)return current.removeAttr(a);else{delete this._data[c];i(this,"change",[c,"remove",current]);return current}},_get:function(a){a=k(a)?a:a.split(".");var c=this._data[a.shift()];return a.length?c?c._get(a):undefined:c},_set:function(a,c){var b=k(a)?a:(""+a).split(".");a=b.shift();var d=this._data[a];if(g(d)&&b.length)d._set(b,c);else if(b.length)throw"jQuery.Observe: set a property on an object that does not exist";else if(c!==d){b=
this._data.hasOwnProperty(a)?"set":"add";this._data[a]=g(c)?l(c,a,this):c;i(this,"change",[a,b,c,d]);d&&d.unbind&&d.unbind("change"+this._namespace)}},bind:function(){$.fn.bind.apply($([this]),arguments);return this},unbind:function(){$.fn.unbind.apply($([this]),arguments);return this},serialize:function(){return m(this,"serialize",{})},attrs:function(a,c){if(a===undefined)return m(this,"attrs",{});a=$.extend(true,{},a);var b,d=q();for(b in this._data){var e=this._data[b],f=a[b];if(f===undefined)c&&
this.removeAttr(b);else{if(g(e)&&g(f))e.attrs(f,c);else e!=f&&this._set(b,f);delete a[b]}}for(b in a){f=a[b];this._set(b,f)}d&&r()}});var s=jQuery.Observe("jQuery.Observe.List",{init:function(a){this.length=0;this._namespace=".list"+ ++p;this.push.apply(this,j(a||[]));this._data=this},serialize:function(){return m(this,"serialize",[])},each:function(){return o.apply(null,[this].concat(j(arguments)))},splice:function(a,c){for(var b=j(arguments),d=0;d<b.length;d++){var e=b[d];if(g(e))b[d]=l(e,a+d,this)}if(c===
undefined)c=b[1]=this.length-a;d=[].splice.apply(this,b);c>0&&i(this,"change",["*","remove",undefined,d,a]);b.length>2&&i(this,"change",["*","add",b.slice(2),d,a]);return d},attrs:function(a,c){if(a===undefined)return m(this,"attrs",[]);a=a.slice(0);for(var b=Math.min(a.length,this.length),d=q(),e=0;e<b;e++){var f=this[e],n=a[e];if(g(f)&&g(n))f.attrs(n,c);else f!=n&&this._set(e,n)}if(a.length>this.length)this.push(a.slice(this.length));else a.length<this.length&&c&&this.splice(a.length);d&&r()}}),
t=function(a){return a[0]&&$.isArray(a[0])?a[0]:j(a)};$.each({push:"length",unshift:0},function(a,c){s.prototype[a]=function(){for(var b=t(arguments),d=c?this.length:0,e=0;e<b.length;e++){var f=b[e];if(g(f))b[e]=l(f,e,this)}e=[][a].apply(this,b);i(this,"change",["*","add",b,undefined,d]);return e}});$.each({pop:"length",shift:0},function(a,c){s.prototype[a]=function(){var b=t(arguments),d=c&&this.length?this.length-1:0;b=[][a].apply(this,b);i(this,"change",["*","remove",undefined,[b],d]);return b}})})(jQuery);
